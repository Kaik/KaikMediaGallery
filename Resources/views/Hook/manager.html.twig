{# #}
<div id="kmgallery_manager_container" class="clearfix">
{#{% set runtimeConfig = {"scale": {"dim": [200, 200] }} %}#}
{% for feature in config.features %}
    <div id="{{ feature.name }}_{{ loop.index0 }}" class="feature col-xs-12 col-sm-4 col-md-3 col-lg-2">
        <span class="feature-name">{{ feature.title }}</span>
        <div class="item">
                <div class="progress hide" style="height: 4px; margin:0px; padding:0px;">
                  <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <div class="error-message alert alert-danger hide" role="alert">{{ __('Media upload failed!. Please try again.') }}</div>
                {% if feature.relation.media is defined and feature.relation.media.mediaExtra.fileName is defined and feature.relation.media.mediaExtra.fileName is not empty %}
                    <img src="{{ ('/uploads/' ~ (feature.relation.media.mediaExtra.subdir is defined ? feature.relation.media.mediaExtra.subdir ~ '/' : '') ~ feature.relation.media.mediaExtra.fileName)|imagine_filter('dynamic', {"thumbnail": {"size": [200, 200] }}) }}" />
                {% else %}
                    <img class="hide" src="" />
                {% endif %}
        </div>
        <div class="actions btn-group btn-group-sm btn-group-justified" role="group">
                <a href="#"
                   class="re-upload-action btn {% if feature.relation.media is defined and feature.relation.media.mediaExtra.fileName is defined and feature.relation.media.mediaExtra.fileName is not empty %}{% else %} hide {% endif %}"
                   data-handler="image"
                   data-containerid="{{ feature.name }}_{{ loop.index0 }}"
                   data-feature="{{ feature.name }}"
                   data-allowedMimeTypes="{{ feature.mimeTypes }}"
                   data-singleFileMaxSize="{{ feature.singleFileMaxSize }}"
                   data-prefix="{{ feature.prefix|default('') }}"
                   data-dir="{{ feature.dir|default('') }}"
                   > <i class="fa fa-plus" title="{{ __('Select different media') }}"> </i> {{ __('Change') }} </a>

                <a href="#"
                   class="upload-action btn {% if feature.relation.media is defined and feature.relation.media.mediaExtra.fileName is defined and feature.relation.media.mediaExtra.fileName is not empty %} hide {% else %}{% endif %}"
                   data-handler="image"
                   data-containerid="{{ feature.name }}_{{ loop.index0 }}"
                   data-feature="{{ feature.name }}"
                   data-allowedMimeTypes="{{ feature.mimeTypes }}"
                   data-singleFileMaxSize="{{ feature.singleFileMaxSize }}"
                   data-prefix="{{ feature.prefix|default('') }}"
                   data-dir="{{ feature.dir|default('') }}"
                   > <i class="fa fa-plus" title="{{ __('Select media from your computer') }}"> </i> {{ __('Select') }} </a>

                <a href="#"
                   class="remove-action btn {% if feature.relation.media is defined and feature.relation.media.mediaExtra.fileName is defined and feature.relation.media.mediaExtra.fileName is not empty %}{% else %} hide {% endif %}"
                   data-handler="image"
                   data-containerid="{{ feature.name }}_{{ loop.index0 }}"
                   data-feature="{{ feature.name }}"
                   data-allowedMimeTypes="{{ feature.mimeTypes }}"
                   data-singleFileMaxSize="{{ feature.singleFileMaxSize }}"
                   > <i class="fa fa-trash" title="{{ __('Remove') }}"> {{ __('Remove') }} </i>
                </a>
        </div>
        <div class="relation-data">
           <input class="relation-data-media form-control input-sm hide"
                  type="text"
                  name="kmgallery_features[{{ loop.index0 }}][media]"
                  placeholder="{{ __('Media Id') }}"
                  value="{% if feature.relation.media is defined %}{{ feature.relation.media.id }}{% else %}{% endif %}"
                  />

           <input class="relation-data-relation form-control input-sm hide"
                  type="text"
                  name="kmgallery_features[{{ loop.index0 }}][relation]"
                  placeholder="{{ __('Media Relation Id') }}"
                  value="{% if feature.relation is defined and feature.relation is not null and feature.relation.id is defined %}{{ feature.relation.id }}{% else %}{% endif %}"
                  />
           {% if feature.extra_title == '1' %}
           <input class="relation-data-title form-control input-sm {% if feature.relation.media is defined and feature.relation.media.mediaExtra.fileName is defined and feature.relation.media.mediaExtra.fileName is not empty %}{% else %} hide {% endif %}"
                  type="text"
                  name="kmgallery_features[{{ loop.index0 }}][relationExtra][title]"
                  placeholder="{{ __('Title') }}"
                  value="{% if feature.relation.relationExtra is defined and feature.relation.relationExtra.title is defined and feature.relation.relationExtra.title is not empty %}{{ feature.relation.relationExtra.title }}{% else %}{% endif %}"
                  />
           {% endif %}
           {% if feature.extra_legal == '1' %}
           <input class="relation-data-copyright form-control input-sm {% if feature.relation.media is defined and feature.relation.media.mediaExtra.fileName is defined and feature.relation.media.mediaExtra.fileName is not empty %}{% else %} hide {% endif %}"
                  type="text"
                  name="kmgallery_features[{{ loop.index0 }}][relationExtra][legal]"
                  placeholder="{{ __('Copyright') }}"
                  value="{% if feature.relation.relationExtra is defined and feature.relation.relationExtra.legal is defined and feature.relation.relationExtra.legal is not empty %}{{ feature.relation.relationExtra.legal }}{% else %}{% endif %}"
                  />
           {% endif %}
        </div>
    </div>
{% endfor %}

</div>
<!-- /#kmgallery_plugin_container -->
{{ pageAddAsset('stylesheet', zasset('@KaikmediaGalleryModule:css/gallery.plugin.css')) }}
{{ pageAddAsset('javascript', zasset('@KaikmediaGalleryModule:js/Kaikmedia.Gallery.settings.js')) }}
{{ pageAddAsset('javascript', zasset('@KaikmediaGalleryModule:js/Kaikmedia.Gallery.Plugin.js')) }}
{{ pageAddAsset('javascript', zasset('@KaikmediaGalleryModule:js/file-dialog.min.js')) }}

{# <img class="img-responsive" src="/web/uploads/logo.jpg"  {{ zasset('@KaikmediaGalleryModule:images/blank.png') }} />#}
{#{{ dump(config) }}#}
{#{{ pageAddAsset('javascript', zasset('@KaikmediaGalleryModule:js/Kaikmedia.Gallery.Manager.js')) }}#}